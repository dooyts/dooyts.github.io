
import { Character, CharacterRarity, ElementType, BaseSkill, Currency, StatusEffectType, ComputedCharacterStats } from '../types';

export const MAX_CHARACTER_LEVEL_BY_STARS: Record<number, number> = {
  1: 30, 2: 40, 3: 50, 4: 60, 5: 70, 6: 80, 7: 90,
};

export const SHARDS_PER_STAR: Record<number, number> = {
  2: 20, 3: 50, 4: 100, 5: 150, 6: 200, 7: 300,
};

export const STAT_BONUS_PER_STAR: Record<number, number> = { // Percentage increase
  1: 0, 2: 10, 3: 15, 4: 20, 5: 25, 6: 30, 7: 40,
};

const SKILL_UPGRADE_COST_GOLD_BASE = 1000;
const SKILL_UPGRADE_COST_BOOK_NORMAL_BASE = 5;
const SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE = 1;
const HIDDEN_HERO_SKILL_COST_GOLD = 500000;
const HIDDEN_HERO_SKILL_COST_BOOK = 25;


export const BASE_SKILLS_DATA: Record<string, Omit<BaseSkill, 'id'>> = {
  defaultAttack: { name: 'æ™®é€šæ”»æ“Š', description: 'å°å–®é«”æ•µäººé€ æˆ100%æ”»æ“ŠåŠ›çš„å‚·å®³ã€‚', damageMultiplier: 1, emoji: 'âš”ï¸', maxLevel: 10, upgradeCost: (l) => ({ [Currency.GOLD]: 100*l}), upgradeEffect: (l) => ({ damageMultiplier: 1 + (l-1)*0.05 }) },
  s001_water_single: { name: 'æ°´æµæ–¬', description: 'å°å–®é«”æ•µäººé€ æˆ120%æ”»æ“ŠåŠ›çš„æ°´å±¬æ€§å‚·å®³ã€‚', damageMultiplier: 1.2, emoji: 'ðŸ’§', maxLevel: 5, upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * l, [Currency.SKILL_BOOK_NORMAL]: SKILL_UPGRADE_COST_BOOK_NORMAL_BASE * l }), upgradeEffect: (l) => ({damageMultiplier: 1.2 + (l-1)*0.15})},
  s002_water_heal: { name: 'æ²»ç™‚æ³¢', description: 'å›žå¾©æˆ‘æ–¹å–®é«”ç”Ÿå‘½å€¼æœ€ä½Žè§’è‰²50%æ”»æ“ŠåŠ›çš„ç”Ÿå‘½ã€‚', healMultiplier: 0.5, target: 'ally_single_lowest_hp', cooldown: 3, emoji: 'ðŸ’–', maxLevel: 5, upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * l, [Currency.SKILL_BOOK_NORMAL]: SKILL_UPGRADE_COST_BOOK_NORMAL_BASE * l }), upgradeEffect: (l) => ({healMultiplier: 0.5 + (l-1)*0.1})},
  s003_fire_single: { name: 'ç«ç„°è¡æ’ž', description: 'å°å–®é«”æ•µäººé€ æˆ130%æ”»æ“ŠåŠ›çš„ç«å±¬æ€§å‚·å®³ã€‚', damageMultiplier: 1.3, emoji: 'ðŸ”¥', maxLevel: 5, upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * l, [Currency.SKILL_BOOK_NORMAL]: SKILL_UPGRADE_COST_BOOK_NORMAL_BASE * l }), upgradeEffect: (l) => ({damageMultiplier: 1.3 + (l-1)*0.18})},
  s004_fire_buff: { name: 'ç‡ƒç‡’æ„å¿—', description: 'æå‡è‡ªèº«20%æ”»æ“ŠåŠ›ï¼ŒæŒçºŒ2å›žåˆã€‚', cooldown: 4, emoji: 'ðŸ’ª', maxLevel: 3, upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 1.5 * l, [Currency.SKILL_BOOK_ADVANCED]: SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE * l }), 
    buffs: [{ stat: 'attack_increase', value: 20, duration: 2, targetType: 'self' }], 
    upgradeEffect: (l) => ({ buffs: [{ stat: 'attack_increase', value: 20 + (l-1)*5, duration: 2 + Math.floor((l-1)/2), targetType: 'self' }] })
  },
  s005_wind_aoe: { name: 'é¢¨åˆƒ', description: 'å°æ•µæ–¹å…¨é«”é€ æˆ80%æ”»æ“ŠåŠ›çš„é¢¨å±¬æ€§å‚·å®³ã€‚', damageMultiplier: 0.8, target: 'enemy_all', emoji: 'ðŸƒ', maxLevel: 5, upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * l, [Currency.SKILL_BOOK_NORMAL]: SKILL_UPGRADE_COST_BOOK_NORMAL_BASE * l }), upgradeEffect: (l) => ({damageMultiplier: 0.8 + (l-1)*0.1})},
  s006_wind_buff: { name: 'ç–¾é¢¨æ­¥', description: 'æå‡è‡ªèº«30%é€Ÿåº¦ï¼ŒæŒçºŒ2å›žåˆã€‚', cooldown: 3, emoji: 'ðŸ’¨', maxLevel: 3, upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 1.5 * l, [Currency.SKILL_BOOK_ADVANCED]: SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE * l }), 
    buffs: [{ stat: 'speed_increase', value: 30, duration: 2, targetType: 'self' }], 
    upgradeEffect: (l) => ({ buffs: [{ stat: 'speed_increase', value: 30 + (l-1)*10, duration: 2 + Math.floor((l-1)/2), targetType: 'self' }] })
  },
  s007_thunder_single_stun: { name: 'é›·éœ†è¬éˆž', description: 'å°å–®é«”æ•µäººé€ æˆ200%æ”»æ“ŠåŠ›çš„é›·å±¬æ€§å‚·å®³ï¼Œä¸¦æœ‰30%æ©ŸçŽ‡ä½¿å…¶ç„¡æ³•è¡Œå‹•1å›žåˆã€‚', damageMultiplier: 2.0, emoji: 'âš¡', maxLevel: 5, applyStatusEffects: [{type: StatusEffectType.UNABLE_TO_ACT, chance: 0.3, duration: 1}], upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 2 * l, [Currency.SKILL_BOOK_ADVANCED]: SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE * (l+1) }), upgradeEffect: (l) => ({damageMultiplier: 2.0 + (l-1)*0.25, applyStatusEffects: [{ type: StatusEffectType.UNABLE_TO_ACT, chance: 0.3 + (l-1)*0.05, duration: 1 }]})},
  s008_thunder_multi: { name: 'é›»å…‰çŸ³ç«', description: 'å°æ•µæ–¹éš¨æ©Ÿ3å€‹ç›®æ¨™é€ æˆ100%æ”»æ“ŠåŠ›çš„é›·å±¬æ€§å‚·å®³ã€‚', damageMultiplier: 1.0, cooldown: 2, emoji: 'âœ¨', maxLevel: 5, target: 'random_enemy_targets', numRandomTargets: 3, upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 1.5 * l, [Currency.SKILL_BOOK_NORMAL]: SKILL_UPGRADE_COST_BOOK_NORMAL_BASE * (l+1) }), upgradeEffect: (l) => ({damageMultiplier: 1.0 + (l-1)*0.12})},
  s009_ur_water_aoe_debuff: { name: 'æµ·ç¥žä¹‹æ€’', description: 'å°æ•µæ–¹å…¨é«”é€ æˆ150%æ”»æ“ŠåŠ›çš„æ°´å±¬æ€§å‚·å®³ï¼Œä¸¦é™ä½Žå…¶15%é˜²ç¦¦åŠ›ï¼ŒæŒçºŒ2å›žåˆã€‚', damageMultiplier: 1.5, target: 'enemy_all', emoji: 'ðŸŒŠ', maxLevel: 5, debuffs: [{stat: 'defense_reduction', value: 15, duration: 2, chance: 1, targetType: 'all_enemies'}], upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 3 * l, [Currency.SKILL_BOOK_ADVANCED]: SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE * (l+2) }), upgradeEffect: (l) => ({damageMultiplier: 1.5 + (l-1)*0.2, debuffs: [{stat: 'defense_reduction', value: 15 + (l-1)*5, duration: 2, chance: 1, targetType: 'all_enemies'}]})},
  s010_ur_water_team_heal_shield: { name: 'æ·±æµ·ç¥ç¦', description: 'æˆ‘æ–¹å…¨é«”å›žå¾©100%æ”»æ“ŠåŠ›çš„ç”Ÿå‘½å€¼ã€‚', healMultiplier: 1.0, target: 'ally_all', cooldown: 5, emoji: 'ðŸ›¡ï¸', maxLevel: 3, upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 5 * l, [Currency.SKILL_BOOK_ADVANCED]: SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE * (l*2) }), upgradeEffect: (l) => ({healMultiplier: 1.0 + (l-1)*0.25})},
  s011_ssr_fire_aoe_dot: { name: 'ç…‰ç„çˆ†ç ´', description: 'å°æ•µæ–¹å…¨é«”é€ æˆ160%æ”»æ“ŠåŠ›çš„ç«å±¬æ€§å‚·å®³ï¼Œé™„åŠ 30%å‚·å®³DOT3å›žåˆã€‚', damageMultiplier: 1.6, target: 'enemy_all', emoji: 'ðŸ’¥', maxLevel: 5, applyStatusEffects: [{type: StatusEffectType.DAMAGE_OVER_TIME, dotDamageMultiplier: 0.3, duration: 3, chance: 1}], upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 2.5 * l, [Currency.SKILL_BOOK_ADVANCED]: SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE * (l+1) }), upgradeEffect: (l) => ({damageMultiplier: 1.6 + (l-1)*0.2, applyStatusEffects: [{type: StatusEffectType.DAMAGE_OVER_TIME, dotDamageMultiplier: 0.3 + (l-1)*0.05, duration: 3, chance: 1}]})},
  s012_ssr_fire_passive_buff: { name: 'ä¸å±ˆæˆ°é­‚', description: 'è‡ªèº«ç”Ÿå‘½ä½Žæ–¼30%æ™‚ï¼Œæ”»æ“ŠåŠ›æå‡50%ã€‚(è¢«å‹•)', emoji: 'ðŸ”¥', maxLevel: 1, isPassive: true, buffs: [{stat:'attack_increase', value: 50, duration: 99, targetType:'self' /* condition handled in battle logic */ }], upgradeCost: (l) => ({}), upgradeEffect: (l) => ({}) },
  s013_light_protect: { name: 'è–å…‰å®ˆè­·', description: 'å…¨éšŠé˜²ç¦¦æå‡50%ï¼ŒæŒçºŒ2å›žåˆã€‚', cooldown: 4, emoji: 'âœ¨', maxLevel: 3, buffs: [{stat: 'defense_increase', value: 50, duration: 2, targetType: 'all_allies'}], upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 2 * l, [Currency.SKILL_BOOK_ADVANCED]: SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE * (l+1) }), upgradeEffect: (l) => ({buffs: [{stat: 'defense_increase', value: 50 + (l-1)*10, duration: 2 + Math.floor((l-1)/2), targetType: 'all_allies'}]})},
  s014_dark_sacrifice: { name: 'æš—å½±ç»ç¥­', description: 'å°æ•µæ–¹å–®é«”é€ æˆ300%æ”»æ“ŠåŠ›çš„æš—å±¬æ€§å‚·å®³ï¼Œè‡ªèº«æå¤±10%ç•¶å‰ç”Ÿå‘½ã€‚', damageMultiplier: 3.0, emoji: 'ðŸ’€', maxLevel: 5, specialConditions: [{type: 'self_damage_current_hp_perc', selfDamagePercent: 0.1}], upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 2.5 * l, [Currency.SKILL_BOOK_ADVANCED]: SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE * (l+2) }), upgradeEffect: (l) => ({damageMultiplier: 3.0 + (l-1)*0.3})},
  s015_ur_light_revive: { name: 'å…‰ä¹‹å¥‡è¹Ÿ', description: 'å›žå¾©å…¨éšŠ30%çš„ç”Ÿå‘½å€¼ã€‚', healMultiplier: 0.3, target: 'ally_all', cooldown: 6, emoji: 'ðŸŒŸ', maxLevel: 3, upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 6 * l, [Currency.SKILL_BOOK_ADVANCED]: SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE * (l*3) }), upgradeEffect: (l) => ({healMultiplier: 0.3 + (l-1)*0.1})},
  s016_dark_sr_dot: { name: 'è…è•æš—æµ', description: 'å°æ•µæ–¹å–®é«”é€ æˆ90%æ”»æ“ŠåŠ›çš„æš—å±¬æ€§å‚·å®³ï¼Œä¸¦é™„åŠ 30%å‚·å®³çš„DOT3å›žåˆã€‚', damageMultiplier: 0.9, cooldown: 2, emoji: 'â˜ ï¸', maxLevel: 5, applyStatusEffects: [{type: StatusEffectType.DAMAGE_OVER_TIME, dotDamageMultiplier: 0.3, duration: 3, chance: 1}], upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 1.2 * l, [Currency.SKILL_BOOK_NORMAL]: SKILL_UPGRADE_COST_BOOK_NORMAL_BASE * (l+1) }), upgradeEffect: (l) => ({damageMultiplier: 0.9 + (l-1)*0.1, applyStatusEffects: [{type: StatusEffectType.DAMAGE_OVER_TIME, dotDamageMultiplier: 0.3 + (l-1)*0.05, duration: 3, chance: 1}] }) },
  s017_light_ssr_shield_reflect: { name: 'æ˜Ÿå…‰å£å£˜', description: 'ç‚ºæˆ‘æ–¹å…¨é«”æ–½åŠ ç­‰åŒè‡ªèº«æ”»æ“ŠåŠ›150%çš„è­·ç›¾ï¼ŒæŒçºŒ2å›žåˆã€‚', shieldMultiplier: 1.5, target: 'ally_all', cooldown: 4, emoji: 'ðŸ›¡ï¸', maxLevel: 5, upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 3 * l, [Currency.SKILL_BOOK_ADVANCED]: SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE * (l+2) }), upgradeEffect: (l) => ({shieldMultiplier: 1.5 + (l-1)*0.2, buffs: [{stat: 'defense_increase', value: (l-1)*5, duration:2, targetType:'all_allies'}]}) },
  s018_ur_wind_single_execute: { name: 'çµ‚æœ«é¢¨æš´', description: 'å°å–®é«”æ•µäººé€ æˆ250%æ”»æ“ŠåŠ›çš„é¢¨å±¬æ€§å‚·å®³ã€‚å¦‚æžœç›®æ¨™ç”Ÿå‘½ä½Žæ–¼20%ï¼Œå‰‡é¡å¤–é€ æˆç›®æ¨™æœ€å¤§ç”Ÿå‘½20%çš„çœŸå¯¦å‚·å®³ã€‚é¡å¤–é€ æˆçš„å‚·å®³æœ€é«˜åªèƒ½é€ æˆè‡ªèº«æ”»æ“Šçš„500%', damageMultiplier: 2.5, emoji: 'ðŸŒªï¸', maxLevel: 5, specialConditions: [{type: 'execute', executeHpThreshold: 0.2, executeDamageCapMultiplier: 5}], upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 4 * l, [Currency.SKILL_BOOK_ADVANCED]: SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE * (l*2) }), upgradeEffect: (l) => ({damageMultiplier: 2.5 + (l-1)*0.3, specialConditions: [{type: 'execute', executeHpThreshold: 0.2 + (l-1)*0.01, executeDamageCapMultiplier: 5 + (l-1)*0.5}]})},
  s019_ssr_dark_support_cooldown: { name: 'æ™‚å…‰å›žæº¯', description: 'æ¸›å°‘æˆ‘æ–¹å…¨é«”æŠ€èƒ½å†·å»1å›žåˆã€‚', cooldown: 5, emoji: 'â³', maxLevel: 3, cooldownReductionEffect: {amount: 1, targetType: 'all_allies', chance: 1}, upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 3 * l, [Currency.SKILL_BOOK_ADVANCED]: SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE * (l+2) }), upgradeEffect: (l) => ({cooldownReductionEffect: {amount: 1 + Math.floor((l-1)/2), targetType: 'all_allies', chance: 1}})},
  s020_ur_dark_aoe_life_steal: { name: 'è™›ç„¡åžå™¬', description: 'å°æ•µæ–¹å…¨é«”é€ æˆ180%æ”»æ“ŠåŠ›çš„æš—å±¬æ€§å‚·å®³ï¼Œä¸¦å°‡é€ æˆå‚·å®³çš„30%è½‰åŒ–ç‚ºè‡ªèº«ç”Ÿå‘½ã€‚', damageMultiplier: 1.8, target: 'enemy_all', emoji: 'ðŸŒŒ', maxLevel: 5, specialConditions: [{type: 'life_steal', lifeStealPercent: 0.3}], upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 4 * l, [Currency.SKILL_BOOK_ADVANCED]: SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE * (l*2) }), upgradeEffect: (l) => ({damageMultiplier: 1.8 + (l-1)*0.22, specialConditions: [{type: 'life_steal', lifeStealPercent: 0.3 + (l-1)*0.05}]})},
  s021_ssr_wind_single_crit_buff: { name: 'é¢¨ä¹‹éŠ³è¥²', description: 'å°å–®é«”æ•µäººé€ æˆ220%æ”»æ“ŠåŠ›çš„é¢¨å±¬æ€§å‚·å®³ï¼Œä¸¦æå‡è‡ªèº«20%æš´æ“ŠçŽ‡ï¼ŒæŒçºŒ2å›žåˆã€‚', damageMultiplier: 2.2, cooldown:3, emoji: 'ðŸŒ€', maxLevel: 5, buffs: [{ stat: 'critRate', value: 20, duration: 2, targetType: 'self' }], upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 2.5 * l, [Currency.SKILL_BOOK_ADVANCED]: SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE * (l+1) }), upgradeEffect: (l) => ({damageMultiplier: 2.2 + (l-1)*0.25, buffs: [{ stat: 'critRate', value: 20 + (l-1)*5, duration: 2 + Math.floor((l-1)/2), targetType: 'self' }]})},
  s022_n_fire_dot: { name: 'å°ç«èŠ±', description: 'å°å–®é«”æ•µäººé€ æˆ70%æ”»æ“ŠåŠ›çš„ç«å±¬æ€§å‚·å®³ï¼Œä¸¦é™„åŠ 15%çš„DOTå‚·å®³3å›žåˆã€‚', damageMultiplier: 0.7, emoji: 'ðŸ§¨', maxLevel: 5, applyStatusEffects: [{type: StatusEffectType.DAMAGE_OVER_TIME, dotDamageMultiplier: 0.15, duration: 3, chance: 1}], upgradeCost: (l) => ({ [Currency.GOLD]: 50*l, [Currency.SKILL_BOOK_NORMAL]: l }), upgradeEffect: (l) => ({damageMultiplier: 0.7 + (l-1)*0.05, applyStatusEffects: [{type: StatusEffectType.DAMAGE_OVER_TIME, dotDamageMultiplier: 0.15 + (l-1)*0.03, duration: 3, chance: 1}]})},
  s023_r_wind_evasion: { name: 'å¹»å½±æ­¥', description: 'æå‡è‡ªèº«20%é–ƒé¿çŽ‡ï¼ŒæŒçºŒ2å›žåˆã€‚', cooldown: 3, emoji: 'ðŸŒ¬ï¸', maxLevel: 3, buffs: [{ stat: 'evasion_increase', value: 20, duration: 2, targetType: 'self' }], upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * l, [Currency.SKILL_BOOK_NORMAL]: SKILL_UPGRADE_COST_BOOK_NORMAL_BASE * l }), upgradeEffect: (l) => ({ buffs: [{ stat: 'evasion_increase', value: 20 + (l-1)*10, duration: 2 + Math.floor((l-1)/2), targetType: 'self' }] })},
  s024_sr_thunder_aoe: { name: 'é€£éŽ–é–ƒé›»', description: 'å°æ•µæ–¹å…¨é«”é€ æˆ90%æ”»æ“ŠåŠ›çš„é›·å±¬æ€§å‚·å®³ã€‚', damageMultiplier: 0.9, target: 'enemy_all', emoji: 'ðŸŒ©ï¸', maxLevel: 5, upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 1.8 * l, [Currency.SKILL_BOOK_NORMAL]: SKILL_UPGRADE_COST_BOOK_NORMAL_BASE * (l+1) }), upgradeEffect: (l) => ({damageMultiplier: 0.9 + (l-1)*0.12})},
  s025_ssr_light_team_buff_atk_def: { name: 'è–å…‰ç¥ç¦', description: 'æå‡æˆ‘æ–¹å…¨é«”15%æ”»æ“ŠåŠ›èˆ‡é˜²ç¦¦åŠ›ï¼ŒæŒçºŒ2å›žåˆã€‚', cooldown: 4, emoji: 'â˜€ï¸', maxLevel: 4, buffs: [{stat:'attack_increase', value:15, duration:2, targetType:'all_allies'}, {stat:'defense_increase', value:15, duration:2, targetType:'all_allies'}], upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 3 * l, [Currency.SKILL_BOOK_ADVANCED]: SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE * (l+2) }), upgradeEffect: (l) => ({buffs: [{stat:'attack_increase', value:15+(l-1)*5, duration:2+Math.floor((l-1)/2), targetType:'all_allies'}, {stat:'defense_increase', value:15+(l-1)*5, duration:2+Math.floor((l-1)/2), targetType:'all_allies'}]})},
  s026_ur_dark_single_instant_kill: { name: 'å†¥ç•Œè£æ±º', description: 'å°å–®é«”æ•µäººé€ æˆ150%æ”»æ“ŠåŠ›çš„æš—å±¬æ€§å‚·å®³ã€‚è‹¥ç›®æ¨™ç”Ÿå‘½ä½Žæ–¼15%ï¼Œå‰‡å‚·å®³ç¿»å€ã€‚', damageMultiplier: 1.5, cooldown: 5, emoji: 'âš–ï¸', maxLevel: 3, specialConditions: [{type: 'if_hp_below_threshold_extra_damage', hpThresholdPercent: 0.15, extraDamageMultiplier: 2}], upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 5 * l, [Currency.SKILL_BOOK_ADVANCED]: SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE * (l*2.5) }), upgradeEffect: (l) => ({damageMultiplier: 1.5 + (l-1)*0.2, specialConditions: [{type: 'if_hp_below_threshold_extra_damage', hpThresholdPercent: 0.15 + (l-1)*0.02, extraDamageMultiplier: 2 + (l-1)*0.2}]})},
  s027_water_r_shield_self: { name: 'æ°´ç›¾', description: 'ç‚ºè‡ªèº«æ–½åŠ ç­‰åŒæ”»æ“ŠåŠ›100%çš„è­·ç›¾ï¼ŒæŒçºŒ2å›žåˆã€‚', shieldMultiplier: 1.0, target: 'self', cooldown: 3, emoji: 'ðŸ›¡ï¸', maxLevel: 5, upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * l, [Currency.SKILL_BOOK_NORMAL]: SKILL_UPGRADE_COST_BOOK_NORMAL_BASE * l }), upgradeEffect: (l) => ({shieldMultiplier: 1.0 + (l-1)*0.2})},
  // s028_fire_sr_counter removed
  s029_wind_ssr_aoe_spd_debuff: { name: 'é¢¶é¢¨ä¹‹ç¸›', description: 'å°æ•µæ–¹å…¨é«”é€ æˆ120%æ”»æ“ŠåŠ›çš„é¢¨å±¬æ€§å‚·å®³ï¼Œä¸¦é™ä½Žç›®æ¨™20%é€Ÿåº¦ï¼ŒæŒçºŒ2å›žåˆã€‚', damageMultiplier: 1.2, target: 'enemy_all', cooldown: 4, emoji: 'â›“ï¸', maxLevel: 5, debuffs: [{stat: 'speed_reduction', value: 20, duration: 2, chance: 1, targetType: 'all_enemies'}], upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 2.8 * l, [Currency.SKILL_BOOK_ADVANCED]: SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE * (l+1) }), upgradeEffect: (l) => ({damageMultiplier: 1.2 + (l-1)*0.15, debuffs: [{stat: 'speed_reduction', value: 20 + (l-1)*5, duration: 2, chance: 1, targetType: 'all_enemies'}]})},
  s030_thunder_ur_passive_enhance_aoe: { name: 'é›·ç¥žé ˜åŸŸ', description: 'è‡ªèº«å­˜æ´»æ™‚ï¼Œæˆ‘æ–¹å…¨é«”æ”»æ“ŠåŠ›æå‡15%ã€‚(è¢«å‹•)', emoji: 'ðŸ‘‘', maxLevel: 1, isPassive: true, buffs: [{stat: 'attack_increase', value: 15, duration: 99, targetType: 'all_allies'}], upgradeCost: (l) => ({}), upgradeEffect: (l) => ({})},
  s031_light_n_single_heal: { name: 'å¾®å…‰æ²»ç™‚', description: 'å›žå¾©æˆ‘æ–¹å–®é«”ç”Ÿå‘½å€¼æœ€ä½Žè§’è‰²30%æ”»æ“ŠåŠ›çš„ç”Ÿå‘½ã€‚', healMultiplier: 0.3, target: 'ally_single_lowest_hp', cooldown: 2, emoji: 'ðŸ’¡', maxLevel: 5, upgradeCost: (l) => ({ [Currency.GOLD]: 80*l, [Currency.SKILL_BOOK_NORMAL]: Math.ceil(l/2) }), upgradeEffect: (l) => ({healMultiplier: 0.3 + (l-1)*0.08})},
  // Skills for Tung Tung Tung Sahur (c_konami)
  s_sahur_strike: { name: 'Sahur Strike', description: 'å°å–®é«”æ•µäººé€ æˆ1000%æ”»æ“ŠåŠ›çš„å…‰å±¬æ€§å‚·å®³ã€‚', damageMultiplier: 10, emoji: 'ðŸ’¥ðŸªµ', maxLevel: 5, upgradeCost: (l) => ({ [Currency.GOLD]: HIDDEN_HERO_SKILL_COST_GOLD * l, [Currency.SKILL_BOOK_ADVANCED]: HIDDEN_HERO_SKILL_COST_BOOK * l }), upgradeEffect: (l) => ({ damageMultiplier: 10 + (l-1)*2 }) },
  s_tungs_blessing: { name: "Tung's Blessing", description: 'æˆ°é¬¥é–‹å§‹æ™‚ï¼Œæˆ‘æ–¹1å›žåˆå…§100%å…¨å±¬æ€§æå‡ã€‚(è¢«å‹•)', emoji: 'ðŸŒŸðŸªµ', maxLevel: 1, isPassive: true, buffs: [{stat: 'all_stats', value: 100, duration: 2, targetType: 'all_allies'}], upgradeCost: () => ({}), upgradeEffect: (l) => ({}) },
  s_echoing_woods: { name: 'Echoing Woods', description: 'å°æ•µæ–¹å…¨é«”é€ æˆ300%æ”»æ“ŠåŠ›çš„å…‰å±¬æ€§å‚·å®³ï¼Œä¸¦æœ‰25%æ©ŸçŽ‡ä½¿å…¶ç„¡æ³•è¡Œå‹•2å›žåˆã€‚', damageMultiplier: 3, target: 'enemy_all', cooldown: 4, emoji: 'ðŸŒ³ðŸªµ', maxLevel: 3, applyStatusEffects: [{type: StatusEffectType.UNABLE_TO_ACT, chance: 0.25, duration: 2}], upgradeCost: (l) => ({ [Currency.GOLD]: HIDDEN_HERO_SKILL_COST_GOLD * 1.5 * l, [Currency.SKILL_BOOK_ADVANCED]: HIDDEN_HERO_SKILL_COST_BOOK * 1.5 * l }), upgradeEffect: (l) => ({ damageMultiplier: 3 + (l-1)*0.5, applyStatusEffects: [{ type: StatusEffectType.UNABLE_TO_ACT, chance: 0.25 + (l-1)*0.1, duration: 2 }] }) },
  // Skills for Cappuccino Assassino (c_cappuccino)
  s_caffeine_rush: { name: 'Caffeine Rush', description: 'æˆ‘æ–¹å…¨é«”é€Ÿåº¦æå‡50%ã€æš´æ“ŠçŽ‡æå‡30%ï¼ŒæŒçºŒ3å›žåˆã€‚', cooldown: 4, emoji: 'ðŸ’¨â˜•', maxLevel: 3, buffs: [{stat: 'speed_increase', value: 50, duration: 3, targetType: 'all_allies'}, {stat: 'critRate', value: 30, duration: 3, targetType: 'all_allies'}], upgradeCost: (l) => ({ [Currency.GOLD]: HIDDEN_HERO_SKILL_COST_GOLD * l, [Currency.SKILL_BOOK_ADVANCED]: HIDDEN_HERO_SKILL_COST_BOOK * l }), upgradeEffect: (l) => ({ buffs: [{stat: 'speed_increase', value: 50 + (l-1)*10, duration: 3 + (l-1), targetType: 'all_allies'}, {stat: 'critRate', value: 30 + (l-1)*5, duration: 3 + (l-1), targetType: 'all_allies'}] }) },
  s_espresso_shot: { name: 'Espresso Shot', description: 'å°å–®é«”æ•µäººé€ æˆ700%æ”»æ“ŠåŠ›çš„æš—å±¬æ€§å‚·å®³ï¼Œæ­¤æ”»æ“Šç„¡è¦–ç›®æ¨™50%é˜²ç¦¦åŠ›ã€‚', damageMultiplier: 7, cooldown: 0, emoji: 'â˜•ðŸŽ¯', maxLevel: 5, specialConditions: [{type: 'ignore_defense', ignoreDefensePercent: 0.5}], upgradeCost: (l) => ({ [Currency.GOLD]: HIDDEN_HERO_SKILL_COST_GOLD * 1.2 * l, [Currency.SKILL_BOOK_ADVANCED]: HIDDEN_HERO_SKILL_COST_BOOK * 1.2 * l }), upgradeEffect: (l) => ({ damageMultiplier: 7 + (l-1)*1.5, specialConditions: [{type: 'ignore_defense', ignoreDefensePercent: 0.5 + (l-1)*0.05}] }) },
  s_shadow_blend: { name: 'Shadow Blend', description: 'æˆ°é¬¥é–‹å§‹æ™‚ï¼ŒæŒçºŒ2å›žåˆï¼Œæ”»æ“ŠåŠ›æå‡100%ã€‚(è¢«å‹•)', emoji: 'ðŸ‘¤â˜•', maxLevel: 1, isPassive: true, buffs: [{stat: 'attack_increase', value: 100, duration: 2, targetType: 'self'}], upgradeCost: () => ({}), upgradeEffect: (l) => ({}) },
  // Skills for Tralalero Tralala (c_tralala)
  s_oceans_fury: { name: "Ocean's Fury", description: 'å°æ•µæ–¹å…¨é«”é€ æˆ350%æ”»æ“ŠåŠ›çš„æ°´å±¬æ€§å‚·å®³ï¼Œä¸¦å¸è¡€å‚·å®³çš„50%', damageMultiplier: 3.5, target: 'enemy_all', cooldown: 3, emoji: 'ðŸŒŠðŸ©¸', maxLevel: 5, specialConditions: [{type: 'life_steal', lifeStealPercent: 0.5}], upgradeCost: (l) => ({ [Currency.GOLD]: HIDDEN_HERO_SKILL_COST_GOLD * l, [Currency.SKILL_BOOK_ADVANCED]: HIDDEN_HERO_SKILL_COST_BOOK * l }), upgradeEffect: (l) => ({ damageMultiplier: 3.5 + (l-1)*0.5, specialConditions: [{type: 'life_steal', lifeStealPercent: 0.5 + (l-1)*0.05}] }) },
  s_apex_predator: { name: 'Apex Predator', description: 'è‡ªèº«ç”Ÿå‘½å€¼å…¨æ»¿æ™‚ï¼Œå›žåˆé–‹å§‹æ™‚æ”»æ“ŠåŠ›æå‡75%ï¼ŒæŒçºŒ1å›žåˆã€‚(è¢«å‹•)', emoji: 'ðŸ’ªðŸ¦ˆ', maxLevel: 1, isPassive: true, buffs: [{stat:'attack_increase', value: 75, duration: 1, targetType:'self' /* condition handled in battle logic */ }], upgradeCost: () => ({}), upgradeEffect: (l) => ({}) },
  s_frenzied_bite: { name: 'Frenzied Bite', description: 'å°å–®é«”æ•µäººé€ æˆ500%æ”»æ“ŠåŠ›çš„æ°´å±¬æ€§å‚·å®³ã€‚ç›®æ¨™èº«ä¸Šæ¯æœ‰ä¸€å€‹DOTæˆ–ç„¡æ³•è¡Œå‹•ï¼Œæ­¤æŠ€èƒ½å‚·å®³æå‡20%ã€‚', damageMultiplier: 5, emoji: 'ðŸ¦·ðŸŽ¯', maxLevel: 3, specialConditions: [{type: 'damage_boost_per_debuff', damageBoostPerDebuffPercent: 0.2}], upgradeCost: (l) => ({ [Currency.GOLD]: HIDDEN_HERO_SKILL_COST_GOLD * 1.5 * l, [Currency.SKILL_BOOK_ADVANCED]: HIDDEN_HERO_SKILL_COST_BOOK * 1.5 * l }), upgradeEffect: (l) => ({ damageMultiplier: 5 + (l-1)*1, specialConditions: [{type: 'damage_boost_per_debuff', damageBoostPerDebuffPercent: 0.2 + (l-1)*0.05}] }) },
  // Skills for Bombardiro Crocodilo (c_bombardiro)
  s_swamp_terror: { name: 'Swamp Terror', description: 'å°æ•µæ–¹å…¨é«”é€ æˆ400%æ”»æ“ŠåŠ›çš„æ°´å±¬æ€§å‚·å®³ï¼Œä¸¦é™„åŠ é˜²ç¦¦åŠ›ä¸‹é™50%æ•ˆæžœï¼ŒæŒçºŒ2å›žåˆã€‚', damageMultiplier: 4, target: 'enemy_all', cooldown: 0, emoji: 'ðŸŠðŸŒŠ', maxLevel: 5, debuffs: [{stat: 'defense_reduction', value: 50, duration: 2, chance: 1, targetType: 'all_enemies'}], upgradeCost: (l) => ({ [Currency.GOLD]: HIDDEN_HERO_SKILL_COST_GOLD * l, [Currency.SKILL_BOOK_ADVANCED]: HIDDEN_HERO_SKILL_COST_BOOK * l }), upgradeEffect: (l) => ({ damageMultiplier: 4 + (l-1)*0.6, debuffs: [{stat: 'defense_reduction', value: 50 + (l-1)*5, duration: 2, chance: 1, targetType: 'all_enemies'}] }) },
  s_death_roll: { name: 'Death Roll', description: 'å°å–®é«”æ•µäººé€ æˆ600%æ”»æ“ŠåŠ›çš„æ°´å±¬æ€§å‚·å®³ã€‚è‹¥æ­¤æŠ€èƒ½æ“Šæ®ºç›®æ¨™ï¼Œå‰‡ç«‹å³é‡ç½®æ­¤æŠ€èƒ½å†·å»æ™‚é–“ã€‚', damageMultiplier: 6, cooldown: 5, emoji: 'ðŸ”„ðŸŠ', maxLevel: 3, specialConditions: [{type: 'reset_cooldown_on_kill'}], upgradeCost: (l) => ({ [Currency.GOLD]: HIDDEN_HERO_SKILL_COST_GOLD * 1.8 * l, [Currency.SKILL_BOOK_ADVANCED]: HIDDEN_HERO_SKILL_COST_BOOK * 1.8 * l }), upgradeEffect: (l) => ({ damageMultiplier: 6 + (l-1)*1.5 }) },
  s_thick_hide: { name: 'Thick Hide', description: 'å…ç–«DOTèˆ‡ç„¡æ³•è¡Œå‹•ã€‚å—åˆ°çš„æš´æ“Šå‚·å®³é™ä½Ž30%ã€‚(è¢«å‹•)', emoji: 'ðŸ›¡ï¸ðŸŠ', maxLevel: 1, isPassive: true, buffs: [{stat: 'crit_chance_reduction', value: 30, duration: 99, targetType: 'self' /* Immunity handled in battle logic */ }], upgradeCost: () => ({}), upgradeEffect: (l) => ({}) },
  // Skills for Mo Guan Yu (c_moguanyu)
  s_mgy_demon_slash: { name: 'é­”ç¥žæ–¬', description: 'å°å–®é«”æ•µäººé€ æˆ280%æ”»æ“ŠåŠ›çš„æš—å±¬æ€§å‚·å®³ï¼Œè‡ªèº«è¡€é‡é«˜æ–¼50%æ™‚ï¼Œé¡å¤–é€ æˆ150%å‚·å®³ã€‚', damageMultiplier: 2.8, emoji: 'ðŸ‘¹âš”ï¸', cooldown: 3, maxLevel: 5, specialConditions: [{ type: 'if_hp_above_threshold_extra_damage', hpThresholdPercent: 0.5, extraDamageMultiplier: 1.5 }], upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 2.5 * l, [Currency.SKILL_BOOK_ADVANCED]: SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE * l }), upgradeEffect: (l) => ({ damageMultiplier: 2.8 + (l-1)*0.3, specialConditions: [{ type: 'if_hp_above_threshold_extra_damage', hpThresholdPercent: 0.5, extraDamageMultiplier: 1.5 + (l-1)*0.2 }] }) },
  s_mgy_crescent_aoe: { name: 'é’é¾åƒæœˆ', description: 'å°æ•µæ–¹å…¨é«”é€ æˆ150%æ”»æ“ŠåŠ›çš„æš—å±¬æ€§å‚·å®³ï¼Œä¸¦é™ä½Žç›®æ¨™15%é˜²ç¦¦åŠ›ï¼ŒæŒçºŒ2å›žåˆã€‚', damageMultiplier: 1.5, target: 'enemy_all', emoji: 'ðŸ‰ðŸŒ™', cooldown: 4, maxLevel: 5, debuffs: [{stat: 'defense_reduction', value: 15, duration: 2, chance: 1, targetType: 'all_enemies'}], upgradeCost: (l) => ({ [Currency.GOLD]: SKILL_UPGRADE_COST_GOLD_BASE * 3 * l, [Currency.SKILL_BOOK_ADVANCED]: SKILL_UPGRADE_COST_BOOK_ADVANCED_BASE * (l > 2 ? l : l-1) }), upgradeEffect: (l) => ({ damageMultiplier: 1.5 + (l-1)*0.2, debuffs: [{stat: 'defense_reduction', value: 15+(l-1)*3, duration: 2, chance: 1, targetType: 'all_enemies'}] }) },
  s_mgy_martial_passive: { name: 'æ­¦è–ä¹‹é­‚', description: 'è‡ªèº«æ”»æ“ŠåŠ›æå‡30%ï¼Œæš´æ“Šå‚·å®³æå‡25%ã€‚(è¢«å‹•)', emoji: 'ðŸ’ªðŸ‘¹', maxLevel: 1, isPassive: true, buffs: [{stat: 'attack_increase', value: 30, duration: 99, targetType: 'self'}, {stat: 'critDmg', value: 25, duration: 99, targetType: 'self'}], upgradeCost: () => ({}), upgradeEffect: (l) => ({}) },

  // World Boss Skills - Agni (Fire Dragon)
  wb_agni_p_aura: { name: 'ç«å±±éˆæ°£', description: 'å›žåˆé–‹å§‹æ™‚ï¼Œå°å…¨é«”æ•µäººé€ æˆé˜¿æ ¼å°¼æ”»æ“ŠåŠ›100%çš„ç«å±¬æ€§çœŸå¯¦å‚·å®³ã€‚é˜¿æ ¼å°¼å…ç–«DOTèˆ‡ç„¡æ³•è¡Œå‹•ã€‚(è¢«å‹•)', emoji: 'ðŸŒ‹', isPassive: true, maxLevel: 1, upgradeCost: () => ({}) },
  wb_agni_p_skin: { name: 'ç†”å²©å¤–æ®¼', description: 'å—åˆ°çš„æš´æ“Šå‚·å®³é™ä½Ž50%ã€‚(è¢«å‹•)', emoji: 'ðŸ§±', isPassive: true, maxLevel: 1, upgradeCost: () => ({}) },
  wb_agni_a_breath: { name: 'ç…‰ç„åæ¯', description: 'å°å…¨é«”æ•µäººé€ æˆ250%æ”»æ“ŠåŠ›çš„ç«å±¬æ€§å‚·å®³ï¼Œä¸¦æ–½åŠ DOT(æ¯å›žåˆ30%æ”»æ“ŠåŠ›)ï¼ŒæŒçºŒ3å›žåˆã€‚', emoji: 'ðŸ”¥ðŸ’¨', target: 'enemy_all', cooldown: 3, damageMultiplier: 2.5, applyStatusEffects: [{type: StatusEffectType.DAMAGE_OVER_TIME, dotDamageMultiplier: 0.3, duration: 3, chance: 1}], maxLevel: 1, upgradeCost: () => ({}) },
  wb_agni_a_eruption: { name: 'å²©æ¼¿å™´ç™¼', description: 'å°å–®é«”æ•µäººé€ æˆ400%æ”»æ“ŠåŠ›çš„ç«å±¬æ€§å‚·å®³ï¼Œ50%æ©ŸçŽ‡é™ä½Žç›®æ¨™30%é˜²ç¦¦åŠ›ï¼ŒæŒçºŒ2å›žåˆã€‚', emoji: 'ðŸŒ‹ðŸ’¥', cooldown: 4, damageMultiplier: 4.0, debuffs: [{stat: 'defense_reduction', value: 30, duration: 2, chance: 0.5, targetType: 'enemy_single'}], maxLevel: 1, upgradeCost: () => ({}) },
  wb_agni_a_worldfire: { name: 'æ»…ä¸–ä¹‹ç«', description: 'å°å…¨é«”æ•µäººé€ æˆå…¶ç•¶å‰ç”Ÿå‘½20%çš„å‚·å®³(å‚·å®³ä¸Šé™ç‚ºé˜¿æ ¼å°¼æ”»æ“ŠåŠ›çš„5000%)ï¼Œé˜¿æ ¼å°¼å›žå¾©é€ æˆç¸½å‚·å®³50%çš„ç”Ÿå‘½ã€‚', emoji: 'â˜„ï¸ðŸŒ', target: 'enemy_all', cooldown: 5, specialConditions: [{type: 'execute', executeHpThreshold: 1.0, executeDamageCapMultiplier: 50 /* Special: executeDamage is % current HP*/}, {type: 'life_steal', lifeStealPercent: 0.5}], maxLevel: 1, upgradeCost: () => ({}) },

  // World Boss Skills - Cocytus (Ice Golem)
  wb_cocytus_p_frostbite: { name: 'åˆºéª¨åš´å¯’', description: 'å›žåˆé–‹å§‹æ™‚ï¼Œæ‰€æœ‰æ•µäºº25%ç•¶å›žåˆç„¡æ³•è¡Œå‹•ã€‚(è¢«å‹•)', emoji: 'â„ï¸ðŸ¥¶', isPassive: true, maxLevel: 1, upgradeCost: () => ({}), applyStatusEffects: [{type: StatusEffectType.UNABLE_TO_ACT, chance: 0.25, duration: 1}] }, // Note: This needs to be applied to enemies
  wb_cocytus_p_glacial_armor: { name: 'å†°å·è­·ç”²', description: 'å—åˆ°çš„éžæš´æ“Šå‚·å®³é™ä½Ž30%ã€‚æ¯æ¬¡å—åˆ°æ”»æ“Šæ™‚ï¼Œæœ‰25%æ©ŸçŽ‡ä½¿æ”»æ“Šè€…ç„¡æ³•è¡Œå‹•1å›žåˆã€‚', emoji: 'ðŸ§ŠðŸ›¡ï¸', isPassive: true, maxLevel: 1, upgradeCost: () => ({}) }, // 'unable to act' on attacker
  wb_cocytus_a_blizzard: { name: 'æš´é¢¨é›ª', description: 'å°å…¨é«”æ•µäººé€ æˆ200%æ”»æ“ŠåŠ›çš„æ°´å±¬æ€§å‚·å®³ï¼Œä¸¦æœ‰40%æ©ŸçŽ‡ä½¿ç›®æ¨™ç„¡æ³•è¡Œå‹•1å›žåˆã€‚', emoji: 'ðŸŒ¨ï¸â„ï¸', target: 'enemy_all', cooldown: 3, damageMultiplier: 2.0, applyStatusEffects: [{type: StatusEffectType.UNABLE_TO_ACT, chance: 0.4, duration: 1}], maxLevel: 1, upgradeCost: () => ({}) },
  wb_cocytus_a_ice_prison: { name: 'å†°ç‰¢è¡“', description: 'å°å–®é«”æ•µäººé€ æˆ350%æ”»æ“ŠåŠ›çš„æ°´å±¬æ€§å‚·å®³ï¼Œå¿…å®šä½¿ç›®æ¨™ç„¡æ³•è¡Œå‹•2å›žåˆã€‚', emoji: 'ðŸ§ŠðŸ”—', cooldown: 4, damageMultiplier: 3.5, applyStatusEffects: [{type: StatusEffectType.UNABLE_TO_ACT, chance: 1.0, duration: 2}], maxLevel: 1, upgradeCost: () => ({}) },
  wb_cocytus_a_absolute_zero: { name: 'çµ•å°é›¶åº¦', description: 'å°å…¨é«”æ•µäººé€ æˆ15%æœ€å¤§ç”Ÿå‘½çš„çœŸå¯¦å‚·å®³(å‚·å®³ä¸Šé™ç‚ºç§‘è³½ç‰¹æ–¯æ”»æ“ŠåŠ›çš„400%)ï¼Œä¸¦ä½¿å…¶æ”»æ“ŠåŠ›ä¸‹é™25%ï¼ŒæŒçºŒ2å›žåˆã€‚', emoji: 'ðŸ¥¶ðŸ“‰', target: 'enemy_all', cooldown: 5, specialConditions: [{type: 'execute', executeHpThreshold: 1.0, executeDamageCapMultiplier: 4 /* Special: executeDamage is % max HP, true damage*/}], debuffs:[{stat:'attack_reduction', value:25, duration:2, targetType:'all_enemies', chance:1}], maxLevel: 1, upgradeCost: () => ({}) },
  
  // World Boss Skills - Typhon (Storm Titan)
  wb_typhon_p_cyclone_shield: { name: 'é¢¶é¢¨è­·ç›¾', description: 'æˆ°é¬¥é–‹å§‹æ™‚ï¼Œç²å¾—ä¸€å€‹èƒ½å¸æ”¶è‡ªèº«æœ€å¤§ç”Ÿå‘½å€¼20%å‚·å®³çš„è­·ç›¾ã€‚è­·ç›¾å­˜åœ¨æ™‚ï¼Œé€Ÿåº¦æå‡30%ã€‚(è¢«å‹•)', emoji: 'ðŸŒªï¸ðŸ›¡ï¸', isPassive: true, maxLevel: 1, upgradeCost: () => ({}) },
  wb_typhon_p_eye_of_storm: { name: 'é¢¨æš´ä¹‹çœ¼', description: 'å°æ‰€æœ‰è¡€é‡ä½Žæ–¼50%çš„æ•µäººï¼Œæ”»æ“Šé€ æˆ200%å‚·å®³ã€‚(è¢«å‹•)', emoji: 'ðŸ‘ï¸ðŸŒªï¸', isPassive: true, maxLevel: 1, upgradeCost: () => ({}), specialConditions: [{type: 'if_hp_below_threshold_extra_damage', hpThresholdPercent: 0.5, extraDamageMultiplier: 2.0 }]}, // This is now a damage boost
  wb_typhon_a_chain_lightning: { name: 'é€£éŽ–é–ƒé›»', description: 'å°æ•µæ–¹éš¨æ©Ÿ3å€‹ç›®æ¨™é€ æˆ180%æ”»æ“ŠåŠ›çš„é¢¨å±¬æ€§å‚·å®³ã€‚æ¯æ¬¡å‘½ä¸­æ™‚ï¼Œæœ‰30%æ©ŸçŽ‡é™ä½Žç›®æ¨™10%å‘½ä¸­ï¼ŒæŒçºŒ2å›žåˆã€‚', emoji: 'âš¡ðŸ”—', target: 'random_enemy_targets', numRandomTargets: 3, cooldown: 3, damageMultiplier: 1.8, debuffs: [{stat:'accuracy_perc' as any, value:10, duration:2, chance:0.3, targetType:'enemy_single'}], maxLevel: 1, upgradeCost: () => ({}) },
  wb_typhon_a_gale_force: { name: 'é¢¨ç¥žè¡æ“Š', description: 'å°å–®é«”æ•µäººé€ æˆ450%æ”»æ“ŠåŠ›çš„é¢¨å±¬æ€§å‚·å®³ï¼Œä¸¦æ¸…é™¤è‡ªèº«æ‰€æœ‰è² é¢æ•ˆæžœã€‚ä¸¦è¿½åŠ æ•µäºº20%æœ€å¤§ç”Ÿå‘½å€¼çš„å‚·å®³ã€‚', emoji: 'ðŸ’¨âš”ï¸', cooldown: 4, damageMultiplier: 4.5, maxLevel: 1, upgradeCost: () => ({}), specialConditions: [{type: 'execute', executeHpThreshold: 1.0, executeDamageCapMultiplier: 999 /* Cap handled by description text, large number to not interfere with the 20% max HP part */ }] }, // Special condition for % max HP part needs battle logic
  wb_typhon_a_tempest: { name: 'å¤©ç©ºä¹‹æ€’', description: 'å°å…¨é«”æ•µäººé€ æˆ300%æ”»æ“ŠåŠ›çš„é¢¨å±¬æ€§å‚·å®³ã€‚æ­¤æŠ€èƒ½æš´æ“ŠçŽ‡é¡å¤–æå‡20%ï¼Œæš´æ“Šå‚·å®³é¡å¤–æå‡50%ã€‚', emoji: 'ðŸŒ©ï¸ðŸŒ', target: 'enemy_all', cooldown: 5, damageMultiplier: 3.0, buffs: [{stat:'critRate', value:20, duration:0, targetType:'self'}, {stat:'critDmg', value:50, duration:0, targetType:'self'}], maxLevel: 1, upgradeCost: () => ({}) },
};

const mapSkills = (skillIds: string[]): BaseSkill[] => {
    return skillIds.map(id => {
      const skillData = BASE_SKILLS_DATA[id];
      if (!skillData) {
        console.error(`Skill definition for ID "${id}" not found in BASE_SKILLS_DATA.`);
        // Return a fallback skill or handle the error as appropriate
        return { 
            id, 
            name: "Unknown Skill", 
            description: "Skill data missing.", 
            emoji: "â“", 
            maxLevel: 1, 
            upgradeCost: () => ({}), 
            isPassive: false,
            target: 'enemy_single',
        } as BaseSkill;
      }
      return { id, ...skillData } as BaseSkill;
    }).filter(Boolean);
}

// Hidden heroes base stats (same as c_konami)
const HIDDEN_HERO_BASE_HP = 66666;
const HIDDEN_HERO_BASE_ATK = 6666;
const HIDDEN_HERO_BASE_DEF = 6666;
const HIDDEN_HERO_BASE_SPD = 6666; // Note: This is extremely high.
const HIDDEN_HERO_CRIT_RATE = 25;
const HIDDEN_HERO_CRIT_DMG = 100;
const HIDDEN_HERO_ACCURACY = 100;
const HIDDEN_HERO_EVASION = 20;

export const BASE_CHARACTERS: Character[] = [
  { id: 'c001', name: 'è¦‹ç¿’æ°´å…µ', rarity: CharacterRarity.N, element: ElementType.WATER, baseHp: 800, baseAtk: 80, baseDef: 60, baseSpd: 90, critRate: 5, critDmg: 50, accuracy: 95, evasion: 5, spriteEmoji: 'ðŸ‘®', skills: mapSkills(['defaultAttack', 's001_water_single']) },
  { id: 'c002', name: 'ç«ç„°å¹¼çŠ¬', rarity: CharacterRarity.R, element: ElementType.FIRE, baseHp: 1200, baseAtk: 120, baseDef: 90, baseSpd: 100, critRate: 5, critDmg: 50, accuracy: 95, evasion: 5, spriteEmoji: 'ðŸ•', skills: mapSkills(['defaultAttack', 's003_fire_single']) },
  { id: 'c003', name: 'é¢¨èªžè€…', rarity: CharacterRarity.SR, element: ElementType.WIND, baseHp: 2000, baseAtk: 180, baseDef: 150, baseSpd: 110, critRate: 10, critDmg: 50, accuracy: 95, evasion: 5, spriteEmoji: 'ðŸ§', skills: mapSkills(['defaultAttack', 's005_wind_aoe', 's006_wind_buff']) },
  { id: 'c004', name: 'é›·éœ†é ˜ä¸»', rarity: CharacterRarity.SSR, element: ElementType.THUNDER, baseHp: 3500, baseAtk: 300, baseDef: 250, baseSpd: 120, critRate: 15, critDmg: 60, accuracy: 95, evasion: 10, spriteEmoji: 'ðŸ¦', skills: mapSkills(['defaultAttack', 's007_thunder_single_stun', 's008_thunder_multi']) },
  { id: 'c005', name: 'æµ·æ´‹å¥³çš‡', rarity: CharacterRarity.UR, element: ElementType.WATER, baseHp: 5000, baseAtk: 450, baseDef: 350, baseSpd: 130, critRate: 20, critDmg: 70, accuracy: 100, evasion: 10, spriteEmoji: 'ðŸ‘¸', skills: mapSkills(['defaultAttack', 's009_ur_water_aoe_debuff', 's010_ur_water_team_heal_shield']) },
  { id: 'c006', name: 'ç…‰ç„å›çŽ‹', rarity: CharacterRarity.SSR, element: ElementType.FIRE, baseHp: 3600, baseAtk: 320, baseDef: 240, baseSpd: 115, critRate: 15, critDmg: 65, accuracy: 95, evasion: 10, spriteEmoji: 'ðŸ‘¹', skills: mapSkills(['defaultAttack', 's011_ssr_fire_aoe_dot', 's012_ssr_fire_passive_buff']) },
  { id: 'c007', name: 'è–æ®¿å®ˆè­·è€…', rarity: CharacterRarity.SR, element: ElementType.LIGHT, baseHp: 2500, baseAtk: 150, baseDef: 200, baseSpd: 95, critRate: 5, critDmg: 50, accuracy: 95, evasion: 5, spriteEmoji: 'ðŸ˜‡', skills: mapSkills(['defaultAttack', 's013_light_protect']) },
  { id: 'c008', name: 'æš—å½±åˆºå®¢', rarity: CharacterRarity.SSR, element: ElementType.DARK, baseHp: 3000, baseAtk: 350, baseDef: 180, baseSpd: 135, critRate: 20, critDmg: 70, accuracy: 100, evasion: 15, spriteEmoji: 'ðŸ¥·', skills: mapSkills(['defaultAttack', 's014_dark_sacrifice', 's008_thunder_multi']) },
  { id: 'c009', name: 'å…‰è¼å¤§ç¥­å¸', rarity: CharacterRarity.UR, element: ElementType.LIGHT, baseHp: 4800, baseAtk: 400, baseDef: 400, baseSpd: 110, critRate: 10, critDmg: 50, accuracy: 100, evasion: 5, spriteEmoji: 'ðŸ™', skills: mapSkills(['defaultAttack', 's015_ur_light_revive', 's010_ur_water_team_heal_shield']) }, // s010 is heal all
  { id: 'c010', name: 'æ²™ä¸˜ä¹‹å½±', rarity: CharacterRarity.SR, element: ElementType.DARK, baseHp: 2200, baseAtk: 200, baseDef: 130, baseSpd: 115, critRate: 10, critDmg: 55, accuracy: 95, evasion: 10, spriteEmoji: 'ðŸ‘¤', skills: mapSkills(['defaultAttack', 's016_dark_sr_dot']) },
  { id: 'c011', name: 'æ˜Ÿç•Œæ¼«éŠè€…', rarity: CharacterRarity.SSR, element: ElementType.LIGHT, baseHp: 3700, baseAtk: 280, baseDef: 300, baseSpd: 105, critRate: 15, critDmg: 60, accuracy: 100, evasion: 5, spriteEmoji: 'ðŸš¶', skills: mapSkills(['defaultAttack', 's017_light_ssr_shield_reflect', 's002_water_heal']) }, // s002 is single heal
  { id: 'c012', name: 'é¢¨æš´å¥³æ­¦ç¥ž', rarity: CharacterRarity.UR, element: ElementType.WIND, baseHp: 4900, baseAtk: 480, baseDef: 320, baseSpd: 135, critRate: 25, critDmg: 75, accuracy: 100, evasion: 15, spriteEmoji: 'ðŸ’ƒ', skills: mapSkills(['defaultAttack', 's018_ur_wind_single_execute', 's005_wind_aoe']) },
  { id: 'c013', name: 'è™›ç©ºç·¨ç¹”è€…', rarity: CharacterRarity.SSR, element: ElementType.DARK, baseHp: 3200, baseAtk: 290, baseDef: 280, baseSpd: 110, critRate: 10, critDmg: 50, accuracy: 100, evasion: 5, spriteEmoji: 'ðŸ”®', skills: mapSkills(['defaultAttack', 's019_ssr_dark_support_cooldown', 's016_dark_sr_dot']) },
  { id: 'c014', name: 'å¹½å½±ä¸»å®°', rarity: CharacterRarity.UR, element: ElementType.DARK, baseHp: 5200, baseAtk: 470, baseDef: 330, baseSpd: 125, critRate: 22, critDmg: 72, accuracy: 100, evasion: 12, spriteEmoji: 'ðŸ˜ˆ', skills: mapSkills(['defaultAttack', 's020_ur_dark_aoe_life_steal', 's014_dark_sacrifice']) },
  { id: 'c015', name: 'é¢¨éˆå°„æ‰‹', rarity: CharacterRarity.SSR, element: ElementType.WIND, baseHp: 3400, baseAtk: 310, baseDef: 230, baseSpd: 125, critRate: 18, critDmg: 62, accuracy: 98, evasion: 8, spriteEmoji: 'ðŸ¹', skills: mapSkills(['defaultAttack', 's021_ssr_wind_single_crit_buff', 's005_wind_aoe']) },
  { id: 'c016', name: 'ç«ç„°å“¥å¸ƒæž—', rarity: CharacterRarity.N, element: ElementType.FIRE, baseHp: 750, baseAtk: 90, baseDef: 50, baseSpd: 95, critRate: 5, critDmg: 50, accuracy: 90, evasion: 5, spriteEmoji: 'ðŸ‘º', skills: mapSkills(['defaultAttack', 's022_n_fire_dot']) },
  { id: 'c017', name: 'æ°´å…ƒç´ ä½¿', rarity: CharacterRarity.R, element: ElementType.WATER, baseHp: 1300, baseAtk: 110, baseDef: 100, baseSpd: 98, critRate: 5, critDmg: 50, accuracy: 95, evasion: 5, spriteEmoji: 'ðŸ’§', skills: mapSkills(['defaultAttack', 's001_water_single', 's027_water_r_shield_self']) },
  { id: 'c018', name: 'é¢¨è¡Œç›œè³Š', rarity: CharacterRarity.R, element: ElementType.WIND, baseHp: 1100, baseAtk: 130, baseDef: 80, baseSpd: 115, critRate: 10, critDmg: 55, accuracy: 95, evasion: 10, spriteEmoji: 'ðŸƒ', skills: mapSkills(['defaultAttack', 's005_wind_aoe', 's023_r_wind_evasion']) },
  { id: 'c019', name: 'é›·é›»æ³•å¸«', rarity: CharacterRarity.SR, element: ElementType.THUNDER, baseHp: 1900, baseAtk: 200, baseDef: 140, baseSpd: 105, critRate: 10, critDmg: 50, accuracy: 95, evasion: 5, spriteEmoji: 'ðŸ§™', skills: mapSkills(['defaultAttack', 's008_thunder_multi', 's024_sr_thunder_aoe']) },
  { id: 'c020', name: 'å…‰è¼é¨Žå£«', rarity: CharacterRarity.SSR, element: ElementType.LIGHT, baseHp: 3800, baseAtk: 290, baseDef: 310, baseSpd: 100, critRate: 10, critDmg: 55, accuracy: 100, evasion: 5, spriteEmoji: 'ðŸ›¡ï¸', skills: mapSkills(['defaultAttack', 's013_light_protect', 's025_ssr_light_team_buff_atk_def']) },
  { id: 'c021', name: 'æš—å¤œåˆ¤å®˜', rarity: CharacterRarity.UR, element: ElementType.DARK, baseHp: 5100, baseAtk: 460, baseDef: 340, baseSpd: 128, critRate: 20, critDmg: 70, accuracy: 100, evasion: 10, spriteEmoji: 'âš–ï¸', skills: mapSkills(['defaultAttack', 's026_ur_dark_single_instant_kill', 's016_dark_sr_dot']) },
  { id: 'c022', name: 'éµç”²æˆ°å£«', rarity: CharacterRarity.N, element: ElementType.FIRE, baseHp: 900, baseAtk: 70, baseDef: 80, baseSpd: 80, critRate: 5, critDmg: 50, accuracy: 95, evasion: 0, spriteEmoji: 'ðŸ‘¨â€ðŸš’', skills: mapSkills(['defaultAttack', 's003_fire_single']) },
  { id: 'c023', name: 'ç«ç„°è¡“å£«', rarity: CharacterRarity.SR, element: ElementType.FIRE, baseHp: 2100, baseAtk: 190, baseDef: 140, baseSpd: 108, critRate: 12, critDmg: 55, accuracy: 95, evasion: 5, spriteEmoji: 'ðŸ”¥', skills: mapSkills(['defaultAttack', 's011_ssr_fire_aoe_dot' /* s028 removed */]) },
  { id: 'c024', name: 'é¢¶é¢¨é ˜ä¸»', rarity: CharacterRarity.SSR, element: ElementType.WIND, baseHp: 3550, baseAtk: 305, baseDef: 245, baseSpd: 122, critRate: 16, critDmg: 60, accuracy: 98, evasion: 8, spriteEmoji: 'ðŸ‘‘', skills: mapSkills(['defaultAttack', 's029_wind_ssr_aoe_spd_debuff', 's005_wind_aoe']) },
  { id: 'c025', name: 'é›·ç¥žåŒ–èº«', rarity: CharacterRarity.UR, element: ElementType.THUNDER, baseHp: 5050, baseAtk: 455, baseDef: 355, baseSpd: 132, critRate: 22, critDmg: 72, accuracy: 100, evasion: 10, spriteEmoji: 'âš¡', skills: mapSkills(['defaultAttack', 's007_thunder_single_stun', 's030_thunder_ur_passive_enhance_aoe']) },
  { id: 'c026', name: 'å…‰æ˜Žä¾åƒ§', rarity: CharacterRarity.N, element: ElementType.LIGHT, baseHp: 850, baseAtk: 60, baseDef: 70, baseSpd: 92, critRate: 5, critDmg: 50, accuracy: 98, evasion: 2, spriteEmoji: 'ðŸ§‘â€âš•ï¸', skills: mapSkills(['defaultAttack', 's031_light_n_single_heal']) },
  // Konami Code Hero (already defined, just ensuring it's here)
  { id: 'c_konami', name: 'Tung Tung Tung Sahur', rarity: CharacterRarity.UR, element: ElementType.LIGHT, baseHp: HIDDEN_HERO_BASE_HP, baseAtk: HIDDEN_HERO_BASE_ATK, baseDef: HIDDEN_HERO_BASE_DEF, baseSpd: HIDDEN_HERO_BASE_SPD, critRate: HIDDEN_HERO_CRIT_RATE, critDmg: HIDDEN_HERO_CRIT_DMG, accuracy: HIDDEN_HERO_ACCURACY, evasion: HIDDEN_HERO_EVASION, spriteEmoji: 'ðŸªµ', skills: mapSkills(['s_sahur_strike', 's_tungs_blessing', 's_echoing_woods']) },
  // Cappuccino Assassino
  { id: 'c_cappuccino', name: 'Cappuccino Assassino', rarity: CharacterRarity.UR, element: ElementType.DARK, baseHp: HIDDEN_HERO_BASE_HP, baseAtk: HIDDEN_HERO_BASE_ATK, baseDef: HIDDEN_HERO_BASE_DEF, baseSpd: HIDDEN_HERO_BASE_SPD, critRate: HIDDEN_HERO_CRIT_RATE, critDmg: HIDDEN_HERO_CRIT_DMG, accuracy: HIDDEN_HERO_ACCURACY, evasion: HIDDEN_HERO_EVASION, spriteEmoji: 'â˜•', skills: mapSkills(['s_caffeine_rush', 's_espresso_shot', 's_shadow_blend']) },
  // Tralalero Tralala
  { id: 'c_tralala', name: 'Tralalero Tralala', rarity: CharacterRarity.UR, element: ElementType.WATER, baseHp: HIDDEN_HERO_BASE_HP, baseAtk: HIDDEN_HERO_BASE_ATK, baseDef: HIDDEN_HERO_BASE_DEF, baseSpd: HIDDEN_HERO_BASE_SPD, critRate: HIDDEN_HERO_CRIT_RATE, critDmg: HIDDEN_HERO_CRIT_DMG, accuracy: HIDDEN_HERO_ACCURACY, evasion: HIDDEN_HERO_EVASION, spriteEmoji: 'ðŸ¦ˆ', skills: mapSkills(['s_oceans_fury', 's_apex_predator', 's_frenzied_bite']) },
  // Bombardiro Crocodilo
  { id: 'c_bombardiro', name: 'Bombardiro Crocodilo', rarity: CharacterRarity.UR, element: ElementType.WATER, baseHp: HIDDEN_HERO_BASE_HP, baseAtk: HIDDEN_HERO_BASE_ATK, baseDef: HIDDEN_HERO_BASE_DEF, baseSpd: HIDDEN_HERO_BASE_SPD, critRate: HIDDEN_HERO_CRIT_RATE, critDmg: HIDDEN_HERO_CRIT_DMG, accuracy: HIDDEN_HERO_ACCURACY, evasion: HIDDEN_HERO_EVASION, spriteEmoji: 'ðŸŠ', skills: mapSkills(['s_swamp_terror', 's_death_roll', 's_thick_hide']) },
  // Mo Guan Yu
  { id: 'c_moguanyu', name: 'é­”é—œç¾½', rarity: CharacterRarity.SSR, element: ElementType.DARK, baseHp: 3200, baseAtk: 380, baseDef: 200, baseSpd: 125, critRate: 15, critDmg: 65, accuracy: 100, evasion: 10, spriteEmoji: 'ðŸ‘¹', skills: mapSkills(['s_mgy_demon_slash', 's_mgy_crescent_aoe', 's_mgy_martial_passive']) },
];

// This list is used for Gacha Pools and general game logic, excluding hidden heroes from appearing in NPC teams or random drops.
export const REGULAR_CHARACTERS: Character[] = BASE_CHARACTERS.filter(
  c => !['c_konami', 'c_cappuccino', 'c_tralala', 'c_bombardiro', 'c_moguanyu'].includes(c.id)
);


export const PLAYER_INITIAL_LEVEL = 1;
export const LEVEL_UP_EXP_COST_BASE = 100;
export const LEVEL_UP_GOLD_COST_BASE = 1000;
